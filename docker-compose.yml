services:
  api:
    build: .
    container_name: meditations-rag-api
    ports:
      - "8080:8080"
    environment:
      - APP_HOST=0.0.0.0
      - APP_PORT=8080
      # Ensure these are set in your .env file for Gemini and Qdrant Cloud
      - GOOGLE_API_KEY=${GOOGLE_API_KEY}
      - QDRANT_URL=${QDRANT_URL}
      - QDRANT_API_KEY=${QDRANT_API_KEY}
    env_file:
      - .env
    extra_hosts:
      - "host.docker.internal:host-gateway"
    volumes:
      # Persist huggingface cache if needed locally
      - huggingface_cache:/root/.cache/huggingface
    restart: unless-stopped

volumes:
  huggingface_cache:
