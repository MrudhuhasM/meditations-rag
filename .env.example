# =============================================================================
# MEDITATIONS RAG - Environment Variables Template
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env to version control!

# =============================================================================
# APPLICATION SETTINGS
# =============================================================================
APP_NAME=meditations-rag
APP_VERSION=0.1.0
APP_DESCRIPTION="RAG system for Meditations by Marcus Aurelius"
ENVIRONMENT=development  # development, staging, or production
DEBUG=false

# API Configuration
API_HOST=0.0.0.0
API_PORT=8000
API_PREFIX=/api/v1

# Security
SECRET_KEY=change-me-in-production-use-at-least-32-characters
ALLOWED_HOSTS=localhost,127.0.0.1
CORS_ORIGINS=http://localhost:3000,http://localhost:8000
CORS_CREDENTIALS=true

# Database
DATABASE_URL=sqlite:///./data/meditations.db
DATABASE_ECHO=false
DATABASE_POOL_SIZE=5
DATABASE_MAX_OVERFLOW=10

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=INFO  # TRACE, DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL_CONSOLE=  # Leave empty to use LOG_LEVEL
LOG_LEVEL_FILE=  # Leave empty to use LOG_LEVEL

LOG_FORMAT_JSON=false  # Set to true for JSON formatted logs (recommended for production)
LOG_CONSOLE_ENABLED=true
LOG_CONSOLE_COLORIZE=true
LOG_FILE_ENABLED=true

LOG_DIR=logs
LOG_FILENAME=meditations_rag.log
LOG_ERROR_FILENAME=error.log
LOG_ROTATION=100 MB
LOG_RETENTION=30 days
LOG_COMPRESSION=zip

LOG_BACKTRACE=true
LOG_DIAGNOSE=false  # MUST be false in production
LOG_ENQUEUE=true

# Third-party library logging
LOG_LIBRARY_LEVEL=WARNING
LOG_SUPPRESS_LIBRARIES=urllib3,httpx,httpcore

# =============================================================================
# LLM PROVIDER SETTINGS
# =============================================================================
# Primary provider selection
LLM_PROVIDER=openai  # openai, gemini, or local
EMBEDDING_PROVIDER=openai  # openai, gemini, or local

# Common LLM settings
LLM_DEFAULT_TEMPERATURE=0.7
LLM_REQUEST_TIMEOUT=60
LLM_MAX_RETRIES=3
LLM_RATE_LIMIT_REQUESTS=100
LLM_RATE_LIMIT_TOKENS=100000
LLM_CACHE_ENABLED=true
LLM_CACHE_TTL=3600

# --- OpenAI Settings ---
OPENAI_API_KEY=sk-your-openai-api-key-here
OPENAI_ORGANIZATION=  # Optional
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini
OPENAI_EMBEDDING_MODEL=text-embedding-3-small
OPENAI_TEMPERATURE=0.7
OPENAI_MAX_TOKENS=
OPENAI_TIMEOUT=60
OPENAI_MAX_RETRIES=3
OPENAI_STREAMING=false

# --- Google Gemini Settings ---
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_BASE_URL=https://generativelanguage.googleapis.com/v1beta
GEMINI_MODEL=gemini-1.5-flash
GEMINI_EMBEDDING_MODEL=text-embedding-004
GEMINI_TEMPERATURE=0.7
GEMINI_MAX_TOKENS=
GEMINI_TIMEOUT=60
GEMINI_MAX_RETRIES=3

# --- Local LLM Settings (OpenAI-compatible) ---
LOCAL_LLM_ENABLED=false
LOCAL_LLM_BASE_URL=http://localhost:8080/v1
LOCAL_LLM_API_KEY=not-needed
LOCAL_LLM_MODEL=local-model
LOCAL_LLM_EMBEDDING_MODEL=local-embedding
LOCAL_LLM_TEMPERATURE=0.7
LOCAL_LLM_MAX_TOKENS=
LOCAL_LLM_TIMEOUT=120
LOCAL_LLM_CONTEXT_LENGTH=4096

# =============================================================================
# VECTOR DATABASE SETTINGS
# =============================================================================
VECTORDB_PROVIDER=qdrant  # qdrant, chroma, pinecone, weaviate
VECTORDB_BATCH_SIZE=100
VECTORDB_TIMEOUT=30

# Search settings
SEARCH_TOP_K=5
SEARCH_SCORE_THRESHOLD=0.7
SEARCH_FILTER_ENABLED=true

# --- Qdrant Settings ---
QDRANT_MODE=local  # local, cloud, or server
QDRANT_PATH=data/vector_db/qdrant
QDRANT_URL=http://localhost:6333
QDRANT_API_KEY=  # Required for cloud mode
QDRANT_HTTPS=false
QDRANT_TIMEOUT=30
QDRANT_GRPC_PORT=6334
QDRANT_PREFER_GRPC=false

# Collection settings
QDRANT_COLLECTION_NAME=meditations
QDRANT_VECTOR_SIZE=1536  # Must match embedding model dimension
QDRANT_DISTANCE_METRIC=Cosine  # Cosine, Euclid, or Dot

# Performance
QDRANT_BATCH_SIZE=100
QDRANT_PARALLEL_REQUESTS=4
QDRANT_MAX_RETRIES=3
QDRANT_ON_DISK=false

# HNSW indexing
QDRANT_HNSW_M=16
QDRANT_HNSW_EF_CONSTRUCT=100
QDRANT_HNSW_FULL_SCAN_THRESHOLD=10000

# Optimization
QDRANT_OPTIMIZE_INTERVAL=3600
QDRANT_OPTIMIZE_THRESHOLD=0.1

# =============================================================================
# RAG PIPELINE SETTINGS
# =============================================================================
RAG_ENABLED=true
RAG_MODE=simple  # simple, advanced, or agentic

# Caching
CACHE_ENABLED=true
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# Performance
ASYNC_ENABLED=true
BATCH_PROCESSING=false
BATCH_SIZE=10

# Monitoring
TRACK_METRICS=true
LOG_QUERIES=true
LOG_RESPONSES=false

# --- Document Processing Settings ---
DOCUMENTS_PATH=data/documents
SUPPORTED_FORMATS=txt,pdf,md,html,docx

# Text chunking
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
CHUNK_STRATEGY=recursive  # fixed, semantic, or recursive

# Text cleaning
REMOVE_EXTRA_WHITESPACE=true
NORMALIZE_UNICODE=true
REMOVE_URLS=false
LOWERCASE=false

# Metadata
EXTRACT_METADATA=true
METADATA_FIELDS=title,author,date,source

# --- Retrieval Settings ---
RETRIEVAL_STRATEGY=similarity  # similarity, mmr, or hybrid
TOP_K=5
SCORE_THRESHOLD=0.7

# MMR settings
MMR_DIVERSITY_SCORE=0.3
MMR_FETCH_K=20

# Hybrid search
HYBRID_ALPHA=0.5

# Reranking
RERANK_ENABLED=false
RERANK_MODEL=cross-encoder/ms-marco-MiniLM-L-12-v2
RERANK_TOP_K=3

# Filtering
FILTER_ENABLED=true

# --- Generation Settings ---
SYSTEM_PROMPT="You are a helpful assistant that answers questions based on the provided context from Marcus Aurelius's Meditations."
TEMPERATURE=0.7
MAX_TOKENS=500
TOP_P=0.9
FREQUENCY_PENALTY=0.0
PRESENCE_PENALTY=0.0

# Response control
INCLUDE_SOURCES=true
INCLUDE_CONFIDENCE=true
STREAMING=false

# Safety
MAX_CONTEXT_LENGTH=4000
TRUNCATE_CONTEXT=true
FALLBACK_RESPONSE="I couldn't find relevant information to answer your question."

# =============================================================================
# PRODUCTION DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
# [ ] ENVIRONMENT=production
# [ ] DEBUG=false
# [ ] SECRET_KEY changed from default (32+ characters)
# [ ] Valid API keys set (OPENAI_API_KEY or GEMINI_API_KEY)
# [ ] ALLOWED_HOSTS updated with your domain
# [ ] CORS_ORIGINS updated with your frontend URL
# [ ] LOG_DIAGNOSE=false
# [ ] LOG_LEVEL set to INFO or WARNING
# [ ] LOG_FORMAT_JSON=true (for log aggregation)
# [ ] Database credentials secured
# [ ] Qdrant API key set if using cloud mode
# =============================================================================
